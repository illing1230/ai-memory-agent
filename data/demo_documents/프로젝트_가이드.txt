================================================================================
                    MemGate 프로젝트 가이드라인
================================================================================

1. 프로젝트 개요
--------------------------------------------------------------------------------
MemGate는 AI 기반 메모리 에이전트 시스템으로, 사용자와의 대화 이력 및 문서를
지능적으로 관리하고 검색할 수 있는 플랫폼입니다.

핵심 목표:
  - 대화 맥락을 장기 기억으로 저장·관리
  - 다양한 형식의 문서(PDF, PPTX, DOCX, TXT 등) 인덱싱 및 시맨틱 검색
  - 사용자 질문에 대해 관련 기억과 문서를 기반으로 정확한 답변 생성

2. 아키텍처
--------------------------------------------------------------------------------
  ┌─────────────┐     ┌──────────────┐     ┌─────────────────┐
  │  Frontend    │────▶│  FastAPI      │────▶│  Vector Store   │
  │  (React)     │     │  Backend      │     │  (ChromaDB)     │
  └─────────────┘     └──────┬───────┘     └─────────────────┘
                             │
                      ┌──────▼───────┐
                      │  LLM Engine  │
                      │  (OpenAI)    │
                      └──────────────┘

3. 개발 환경 설정
--------------------------------------------------------------------------------
  3.1 필수 요구 사항
    - Python 3.11 이상
    - Node.js 18 이상 (프론트엔드 개발 시)
    - Docker & Docker Compose (배포 환경)

  3.2 로컬 개발 환경 구축
    $ git clone https://github.com/memgate/ai-memory-agent.git
    $ cd ai-memory-agent
    $ uv venv .venv && source .venv/bin/activate
    $ uv pip install -e ".[dev]"
    $ cp .env.example .env   # API 키 등 환경변수 설정
    $ python -m uvicorn src.main:app --reload

4. 코딩 컨벤션
--------------------------------------------------------------------------------
  4.1 Python
    - PEP 8 준수 (black + ruff 자동 포맷팅)
    - 타입 힌트 필수 적용 (from __future__ import annotations)
    - Docstring은 Google 스타일 사용
    - 모든 퍼블릭 함수에 단위 테스트 작성

  4.2 커밋 메시지
    - Conventional Commits 형식 준수
      예: feat: 문서 인덱싱 파이프라인 추가
          fix: 벡터 검색 시 한글 토크나이저 오류 수정
          docs: API 명세서 업데이트

  4.3 브랜치 전략
    - main: 프로덕션 배포 브랜치
    - develop: 통합 개발 브랜치
    - feature/*: 기능 개발 브랜치
    - hotfix/*: 긴급 수정 브랜치

5. 문서 처리 파이프라인
--------------------------------------------------------------------------------
  5.1 지원 파일 형식
    - PDF  → PyMuPDF(fitz) 파서
    - PPTX → python-pptx 파서
    - DOCX → python-docx 파서
    - TXT  → 일반 텍스트 파서
    - CSV  → pandas 기반 파서

  5.2 처리 흐름
    문서 업로드 → 텍스트 추출 → 청크 분할(chunk) → 임베딩 생성 → 벡터 DB 저장

  5.3 청크 분할 규칙
    - 기본 청크 크기: 512 토큰
    - 오버랩: 64 토큰
    - 구분자 우선순위: 문단 > 문장 > 공백

6. API 엔드포인트 요약
--------------------------------------------------------------------------------
  POST   /api/v1/documents/upload    문서 업로드 및 인덱싱
  GET    /api/v1/documents           문서 목록 조회
  GET    /api/v1/documents/{id}      문서 상세 조회
  DELETE /api/v1/documents/{id}      문서 삭제
  POST   /api/v1/search              시맨틱 검색
  POST   /api/v1/chat                대화 (메모리 기반 응답)
  GET    /api/v1/memories            메모리 목록 조회

7. 테스트
--------------------------------------------------------------------------------
  $ pytest tests/ -v --cov=src --cov-report=html
  $ pytest tests/unit/           # 단위 테스트만 실행
  $ pytest tests/integration/    # 통합 테스트만 실행

  - 테스트 커버리지 목표: 80% 이상
  - PR 머지 전 반드시 CI 통과 확인

8. 배포
--------------------------------------------------------------------------------
  8.1 Docker 배포
    $ docker compose -f docker-compose.prod.yml up -d

  8.2 환경 변수 (필수)
    OPENAI_API_KEY      OpenAI API 키
    CHROMA_HOST         ChromaDB 호스트 주소
    CHROMA_PORT         ChromaDB 포트 (기본 8000)
    DATABASE_URL        PostgreSQL 연결 문자열
    SECRET_KEY          JWT 서명 키

9. 팀 연락처
--------------------------------------------------------------------------------
  - 프로젝트 리드: 김영수 (youngsoo.kim@memgate.io)
  - 백엔드 리드: 이정민 (jungmin.lee@memgate.io)
  - AI/ML 리드: 박서연 (seoyeon.park@memgate.io)
  - DevOps: 최동현 (donghyun.choi@memgate.io)

================================================================================
                         문서 끝 — MemGate Team © 2026
================================================================================
